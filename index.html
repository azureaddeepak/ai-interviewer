<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>AI DevOps Interviewer</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Roboto', Arial, sans-serif;
      text-align: center;
      padding: 30px;
      background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
      color: #333;
      margin: 0;
      min-height: 100vh;
    }
    .container {
      max-width: 900px;
      margin: 0 auto;
      background: white;
      border-radius: 18px;
      box-shadow: 0 12px 40px rgba(0, 0, 0, 0.2);
      padding: 30px;
      overflow: hidden;
    }
    h1 {
      color: #005a9e;
      margin-bottom: 10px;
      font-size: 32px;
      font-weight: 600;
    }
    .welcome-box {
      background: #e3f2fd;
      padding: 20px;
      border-radius: 14px;
      margin: 20px 0;
      text-align: left;
      font-size: 16px;
      line-height: 1.6;
      border: 1px solid #bbdefb;
    }
    .welcome-box strong {
      color: #0d47a1;
    }
    p#question {
      font-size: 18px;
      line-height: 1.6;
      background: #f0f8ff;
      padding: 18px;
      border-radius: 12px;
      margin: 20px 0;
      border: 1px solid #d0ebff;
      font-weight: 500;
    }
    button {
      font-size: 16px;
      padding: 14px 32px;
      margin: 15px 0;
      border: none;
      border-radius: 60px;
      background: #0078d4;
      color: white;
      cursor: pointer;
      font-weight: 600;
      box-shadow: 0 6px 15px rgba(0, 120, 212, 0.4);
      transition: all 0.3s ease;
    }
    button:hover {
      background: #005a9e;
      transform: translateY(-3px);
    }
    button:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none;
    }
    #status, #timer {
      margin: 15px 0;
      font-style: italic;
      color: #555;
      font-size: 16px;
    }
    #timer {
      font-size: 26px;
      font-weight: bold;
      color: #e74c3c;
      display: none;
      background: #fdf2f2;
      padding: 10px 20px;
      border-radius: 10px;
      border: 2px solid #e74c3c;
    }
    #result {
      font-size: 20px;
      font-weight: bold;
      padding: 25px;
      border-radius: 14px;
      margin: 25px auto;
      max-width: 800px;
      display: none;
      line-height: 1.6;
      text-align: center;
    }
    .pass {
      background: #d4edda;
      color: #155724;
      border: 2px solid #c3e6cb;
    }
    .fail {
      background: #f8d7da;
      color: #721c24;
      border: 2px solid #f5c6cb;
    }
    #transcript {
      white-space: pre-wrap;
      background: #f9f9f9;
      padding: 20px;
      border-radius: 12px;
      max-height: 350px;
      overflow-y: auto;
      text-align: left;
      border: 1px solid #ddd;
      margin: 20px 0;
      font-size: 14px;
    }
    .ai-text {
      color: #0078d4;
      font-weight: 600;
      margin: 10px 0;
      display: block;
    }
    .user-text {
      color: #28a745;
      font-weight: 600;
      margin: 10px 0;
      display: block;
    }
    .timestamp {
      color: #6c757d;
      font-size: 12px;
      margin-bottom: 4px;
    }
    .rating {
      color: #FFD700;
      font-size: 22px;
      margin: 12px 0;
      font-weight: bold;
    }
    .feedback {
      color: #555;
      font-size: 14px;
      margin: 5px 0;
      font-style: italic;
    }
    hr {
      margin: 20px 0;
      border: 1px dashed #dee2e6;
    }
    footer {
      margin-top: 30px;
      color: #adb5bd;
      font-size: 14px;
    }
    .header-logo {
      width: 60px;
      height: 60px;
      background: #0078d4;
      border-radius: 50%;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: bold;
      font-size: 24px;
      margin-bottom: 10px;
    }
  </style>
</head>
<body>

  <div class="container">
    <div class="header-logo">ü§ñ</div>
    <h1>AI Interviewer (Azure DevOps + AKS)</h1>

    <!-- Welcome Message -->
    <div class="welcome-box">
      <p><strong>üìå Interview Information:</strong></p>
      <ul style="text-align: left; margin: 10px 0;">
        <li>This interview contains <strong>7 questions</strong> on <strong>Azure DevOps & AKS clusters</strong>.</li>
        <li>After each question, you will have <strong>30 seconds</strong> to answer.</li>
        <li>Each answer will be rated from <strong>1 to 5 stars</strong> with feedback.</li>
        <li>At the end, you'll receive a final result: <strong>Pass or Fail</strong>.</li>
      </ul>
      <p style="font-weight: bold; color: #0d47a1;">üéØ All the best!</p>
    </div>

    <p id="question">Press "Start Interview" to begin.</p>

    <button id="startBtn">üü¢ Start Interview</button>

    <div id="status">Ready when you are.</div>
    <div id="timer">‚è±Ô∏è Time Remaining: <span id="time">30</span> seconds</div>
    <div id="result"></div>

    <h3 style="color:#005a9e; margin-top:30px;">Interview Transcript</h3>
    <div id="transcript"></div>

    <footer>
      ¬© 2025 AI Screening Assistant | Azure DevOps & AKS Role
    </footer>
  </div>

  <script>
    // === INTERVIEW QUESTIONS ===
    const interviewData = [
      "What is the role of Azure DevOps in managing AKS clusters?",
      "How do you deploy an application to AKS using Azure DevOps pipelines?",
      "What are some best practices for securing AKS in CI/CD pipelines?",
      "How do you handle secrets when deploying to AKS from Azure DevOps?",
      "What is the difference between using kubectl and Helm in Azure DevOps pipelines for AKS deployment?",
      "How do you set up monitoring for AKS in an Azure DevOps environment?",
      "How do you implement blue-green or canary deployments in AKS using Azure DevOps?"
    ];

    let currentQ = 0;
    let totalScore = 0;
    let timerInterval = null;

    const synth = window.speechSynthesis;
    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;

    const startBtn = document.getElementById("startBtn");
    const questionEl = document.getElementById("question");
    const statusEl = document.getElementById("status");
    const timerEl = document.getElementById("timer");
    const timeEl = document.getElementById("time");
    const resultEl = document.getElementById("result");
    const transcriptEl = document.getElementById("transcript");

    // Check browser support
    if (!SpeechRecognition) {
      statusEl.textContent = "‚ö†Ô∏è Browser doesn't support voice recognition. Please use Google Chrome.";
      startBtn.disabled = true;
    }

    // Text-to-Speech
    function speak(text) {
      const utter = new SpeechSynthesisUtterance(text);
      utter.rate = 0.9;
      synth.speak(utter);
    }

    // Start Interview
    startBtn.onclick = () => {
      startBtn.disabled = true;
      document.querySelector(".welcome-box").style.display = "none"; // Hide welcome
      statusEl.textContent = "üéôÔ∏è Interview started...";
      timerEl.style.display = "block";
      nextQuestion();
    };

    // Move to next question
    function nextQuestion() {
      if (currentQ >= interviewData.length) {
        showResult();
        return;
      }

      const data = interviewData[currentQ];
      questionEl.textContent = data;
      speak(data);

      // Add AI question to transcript
      const now = new Date();
      const timeStr = now.toLocaleTimeString();
      transcriptEl.innerHTML += `<div class="timestamp">${timeStr}</div><div class="ai-text">AI: ${data}</div>\n`;

      statusEl.textContent = "üéôÔ∏è You have 30 seconds to answer...";
      timerEl.style.display = "block";
      timeEl.textContent = "30";

      // Create new recognition instance
      const recognition = new SpeechRecognition();
      recognition.continuous = false;
      recognition.interimResults = false;

      let finalTranscript = '';

      recognition.onresult = (event) => {
        const transcript = event.results[0][0].transcript;
        finalTranscript += transcript + ' ';
      };

      recognition.onerror = (event) => {
        console.error("Speech error:", event.error);
      };

      recognition.start();

      // Start 30-second timer
      let timeLeft = 30;
      clearInterval(timerInterval);
      timerInterval = setInterval(() => {
        timeLeft--;
        timeEl.textContent = timeLeft;
        if (timeLeft <= 0) {
          clearInterval(timerInterval);
          if (recognition.state !== "inactive") recognition.stop();
        }
      }, 1000);

      // Stop after 30 seconds
      setTimeout(() => {
        if (recognition.state !== "inactive") recognition.stop();

        timerEl.style.display = "none";
        statusEl.textContent = "‚úÖ Answer recorded. Moving to next question...";

        // Save and show answer
        const displayAnswer = finalTranscript.trim() || "No answer recorded.";
        transcriptEl.innerHTML += `<div class="timestamp">${new Date().toLocaleTimeString()}</div><div class="user-text">You: ${displayAnswer}</div>\n`;

        // Score and show rating
        const score = calculateScore(finalTranscript);
        const rating = Math.round(score / 20); // 1‚Äì5
        const feedback = getFeedback(rating);

        transcriptEl.innerHTML += `
          <div class="rating">Rating: ${'‚òÖ'.repeat(rating)}${'‚òÜ'.repeat(5 - rating)}</div>
          <div class="feedback">üí¨ ${feedback}</div>
          <hr>
        `;

        totalScore += score;

        // Next question
        currentQ++;
        setTimeout(nextQuestion, 1000);
      }, 30000);
    }

    // Calculate Score Based on Keywords
    function calculateScore(answer) {
      const keywords = [
        "CI/CD", "pipeline", "build", "deploy", "AKS", "Kubernetes", "Helm", "kubectl", "image", "ACR",
        "secret", "Key Vault", "RBAC", "security", "monitoring", "log", "metric", "blue-green", "canary"
      ];
      const words = answer.toLowerCase().split(/\W+/);
      let matchCount = 0;
      keywords.forEach(word => {
        if (words.includes(word)) matchCount++;
      });
      return (matchCount / keywords.length) * 100;
    }

    // Get Feedback Based on Rating
    function getFeedback(rating) {
      switch (rating) {
        case 5: return "Excellent! You covered all key points.";
        case 4: return "Good! You mentioned most important concepts.";
        case 3: return "Fair. You touched on some relevant topics.";
        case 2: return "Needs improvement. Focus on core practices.";
        case 1: return "Limited. Consider reviewing best practices.";
        default: return "No answer provided.";
      }
    }

    // Show Final Result
    function showResult() {
      const avgScore = totalScore / interviewData.length;
      questionEl.textContent = "‚úÖ Interview Complete!";
      statusEl.textContent = "";
      timerEl.style.display = "none";

      if (avgScore >= 30) {
        resultEl.className = "pass";
        resultEl.innerHTML = "üéâ <strong>Congratulations!</strong> You passed the first round.<br><br>You will be contacted for the second round soon.";
      } else {
        resultEl.className = "fail";
        resultEl.innerHTML = "‚ùå <strong>Sorry</strong>, your skills do not match our requirements.<br><br>Thank you for your time.";
      }
      resultEl.style.display = "block";
    }
  </script>
</body>
</html>
