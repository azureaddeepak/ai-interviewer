<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>AI Interviewer (Azure DevOps)</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      padding: 50px;
      background-color: #f7f9fc;
    }
    button {
      font-size: 16px;
      padding: 12px 24px;
      margin: 10px;
      border: none;
      border-radius: 5px;
      background: #0078d4;
      color: white;
      cursor: pointer;
    }
    button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    #status {
      margin: 20px;
      font-style: italic;
      color: #666;
    }
    pre {
      white-space: pre-wrap;
      background: #fff;
      padding: 15px;
      border-radius: 5px;
      max-width: 800px;
      margin: 20px auto;
      border: 1px solid #ddd;
    }
  </style>
</head>
<body>
  <h1>ü§ñ AI Interviewer (Azure DevOps)</h1>
  <p id="question">Press "Start" to begin your interview.</p>
  <button id="startBtn">üéôÔ∏è Start Interview</button>
  <button id="listenBtn" disabled>üéß Listen to Answer</button>
  <div id="status"></div>
  <pre id="transcript"></pre>

  <script>
    // Azure DevOps + AKS Interview Questions
    const questions = [
      "Hello! I'm your AI interviewer. Can you explain what CI/CD is and how you've used it in Azure DevOps?",
      "Have you used Terraform or ARM templates? Please describe your experience.",
      "Tell me about a time you fixed a broken deployment pipeline.",
      "How do you manage secrets in Azure DevOps pipelines? Have you used Key Vault integration?",
      "Explain how you deploy applications to Azure Kubernetes Service (AKS) using Azure DevOps.",
      "What tools do you use for monitoring and logging in AKS? How do you set up alerts?",
      "Describe your experience with Helm charts in AKS deployments."
    ];

    let currentQ = 0;
    const synth = window.speechSynthesis;
    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
    const recognition = SpeechRecognition ? new SpeechRecognition() : null;

    const startBtn = document.getElementById("startBtn");
    const listenBtn = document.getElementById("listenBtn");
    const questionEl = document.getElementById("question");
    const statusEl = document.getElementById("status");
    const transcriptEl = document.getElementById("transcript");

    // Check if browser supports speech
    if (!recognition) {
      statusEl.textContent = "Your browser doesn't support voice recognition. Try Chrome or Edge.";
      startBtn.disabled = true;
      return;
    }

    // Text-to-Speech
    function speak(text) {
      const utter = new SpeechSynthesisUtterance(text);
      utter.rate = 0.9;
      synth.speak(utter);
    }

    // Start interview
    startBtn.onclick = async () => {
      try {
        await navigator.mediaDevices.getUserMedia({ audio: true });
        statusEl.textContent = "Microphone granted. Starting interview...";
        startBtn.disabled = true;
        nextQuestion();
      } catch (err) {
        statusEl.textContent = "Microphone access denied. Please allow it in browser settings.";
      }
    };

    function nextQuestion() {
      if (currentQ >= questions.length) {
        questionEl.textContent = "Interview complete!";
        statusEl.textContent = "You can review your answers above.";
        return;
      }

      const q = questions[currentQ];
      questionEl.textContent = q;
      speak(q);

      statusEl.textContent = "Listening in 3 seconds...";
      setTimeout(startListening, 3000);
    }

    function startListening() {
      recognition.onresult = (event) => {
        const transcript = event.results[0][0].transcript;
        transcriptEl.textContent += "\nA: " + transcript + "\n";
        statusEl.textContent = "Answer recorded.";
      };

      recognition.onerror = (event) => {
        statusEl.textContent = "Error: " + event.error;
      };

      recognition.start();

      // Stop after 5 seconds
      setTimeout(() => {
        recognition.stop();
        statusEl.textContent = "Listening ended. Moving to next question...";
        currentQ++;
        setTimeout(nextQuestion, 1000);
      }, 5000);
    }
  </script>
</body>
</html>
